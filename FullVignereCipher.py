import CipherInterface

full_table = {
    'A' : {
        'A' : 'O',
        'B' : 'A',
        'C' : 'K',
        'D' : 'M',
        'E' : 'X',
        'F' : 'W',
        'G' : 'N',
        'H' : 'T',
        'I' : 'V',
        'J' : 'E',
        'K' : 'G',
        'L' : 'Y',
        'M' : 'P',
        'N' : 'U',
        'O' : 'J',
        'P' : 'Z',
        'Q' : 'B',
        'R' : 'Q',
        'S' : 'C',
        'T' : 'S',
        'U' : 'H',
        'V' : 'D',
        'W' : 'I',
        'X' : 'R',
        'Y' : 'L',
        'Z' : 'F',
    },
    'B' : {
        'A' : 'P',
        'B' : 'U',
        'C' : 'J',
        'D' : 'Z',
        'E' : 'B',
        'F' : 'Q',
        'G' : 'C',
        'H' : 'S',
        'I' : 'H',
        'J' : 'D',
        'K' : 'I',
        'L' : 'R',
        'M' : 'L',
        'N' : 'F',
        'O' : 'O',
        'P' : 'A',
        'Q' : 'K',
        'R' : 'M',
        'S' : 'X',
        'T' : 'W',
        'U' : 'N',
        'V' : 'T',
        'W' : 'V',
        'X' : 'E',
        'Y' : 'G',
        'Z' : 'Y',
    },
    'C' : {
        'A' : 'U',
        'B' : 'J',
        'C' : 'Z',
        'D' : 'B',
        'E' : 'Q',
        'F' : 'C',
        'G' : 'S',
        'H' : 'H',
        'I' : 'D',
        'J' : 'I',
        'K' : 'R',
        'L' : 'L',
        'M' : 'F',
        'N' : 'O',
        'O' : 'A',
        'P' : 'K',
        'Q' : 'M',
        'R' : 'X',
        'S' : 'W',
        'T' : 'N',
        'U' : 'T',
        'V' : 'V',
        'W' : 'E',
        'X' : 'G',
        'Y' : 'Y',
        'Z' : 'P',
    },
    'D' : {
        'A' : 'I',
        'B' : 'R',
        'C' : 'L',
        'D' : 'F',
        'E' : 'O',
        'F' : 'A',
        'G' : 'K',
        'H' : 'M',
        'I' : 'X',
        'J' : 'W',
        'K' : 'N',
        'L' : 'T',
        'M' : 'V',
        'N' : 'E',
        'O' : 'G',
        'P' : 'Y',
        'Q' : 'P',
        'R' : 'U',
        'S' : 'J',
        'T' : 'Z',
        'U' : 'B',
        'V' : 'Q',
        'W' : 'C',
        'X' : 'S',
        'Y' : 'H',
        'Z' : 'D',
    },
    'E' : {
        'A' : 'B',
        'B' : 'Q',
        'C' : 'C',
        'D' : 'S',
        'E' : 'H',
        'F' : 'D',
        'G' : 'I',
        'H' : 'R',
        'I' : 'L',
        'J' : 'F',
        'K' : 'O',
        'L' : 'A',
        'M' : 'K',
        'N' : 'M',
        'O' : 'X',
        'P' : 'W',
        'Q' : 'N',
        'R' : 'T',
        'S' : 'V',
        'T' : 'E',
        'U' : 'G',
        'V' : 'Y',
        'W' : 'P',
        'X' : 'U',
        'Y' : 'J',
        'Z' : 'Z',
    },
    'F' : {
        'A' : 'N',
        'B' : 'T',
        'C' : 'V',
        'D' : 'E',
        'E' : 'G',
        'F' : 'Y',
        'G' : 'P',
        'H' : 'U',
        'I' : 'J',
        'J' : 'Z',
        'K' : 'B',
        'L' : 'Q',
        'M' : 'C',
        'N' : 'S',
        'O' : 'H',
        'P' : 'D',
        'Q' : 'I',
        'R' : 'R',
        'S' : 'L',
        'T' : 'F',
        'U' : 'O',
        'V' : 'A',
        'W' : 'K',
        'X' : 'M',
        'Y' : 'X',
        'Z' : 'W',
    },
    'G' : {
        'A' : 'D',
        'B' : 'I',
        'C' : 'R',
        'D' : 'L',
        'E' : 'F',
        'F' : 'O',
        'G' : 'A',
        'H' : 'K',
        'I' : 'M',
        'J' : 'X',
        'K' : 'W',
        'L' : 'N',
        'M' : 'T',
        'N' : 'V',
        'O' : 'E',
        'P' : 'G',
        'Q' : 'Y',
        'R' : 'P',
        'S' : 'U',
        'T' : 'J',
        'U' : 'Z',
        'V' : 'B',
        'W' : 'Q',
        'X' : 'C',
        'Y' : 'S',
        'Z' : 'H',
    },
    'H' : {
        'A' : 'R',
        'B' : 'L',
        'C' : 'F',
        'D' : 'O',
        'E' : 'A',
        'F' : 'K',
        'G' : 'M',
        'H' : 'X',
        'I' : 'W',
        'J' : 'N',
        'K' : 'T',
        'L' : 'V',
        'M' : 'E',
        'N' : 'G',
        'O' : 'Y',
        'P' : 'P',
        'Q' : 'U',
        'R' : 'J',
        'S' : 'Z',
        'T' : 'B',
        'U' : 'Q',
        'V' : 'C',
        'W' : 'S',
        'X' : 'H',
        'Y' : 'D',
        'Z' : 'I',
    },
    'I' : {
        'A' : 'G',
        'B' : 'Y',
        'C' : 'P',
        'D' : 'U',
        'E' : 'J',
        'F' : 'Z',
        'G' : 'B',
        'H' : 'Q',
        'I' : 'C',
        'J' : 'S',
        'K' : 'H',
        'L' : 'D',
        'M' : 'I',
        'N' : 'R',
        'O' : 'L',
        'P' : 'F',
        'Q' : 'O',
        'R' : 'A',
        'S' : 'K',
        'T' : 'M',
        'U' : 'X',
        'V' : 'W',
        'W' : 'N',
        'X' : 'T',
        'Y' : 'V',
        'Z' : 'E',
    },
    'J' : {
        'A' : 'F',
        'B' : 'O',
        'C' : 'A',
        'D' : 'K',
        'E' : 'M',
        'F' : 'X',
        'G' : 'W',
        'H' : 'N',
        'I' : 'T',
        'J' : 'V',
        'K' : 'E',
        'L' : 'G',
        'M' : 'Y',
        'N' : 'P',
        'O' : 'U',
        'P' : 'J',
        'Q' : 'Z',
        'R' : 'B',
        'S' : 'Q',
        'T' : 'C',
        'U' : 'S',
        'V' : 'H',
        'W' : 'D',
        'X' : 'I',
        'Y' : 'R',
        'Z' : 'L',
    },
    'K' : {
        'A' : 'Q',
        'B' : 'C',
        'C' : 'S',
        'D' : 'H',
        'E' : 'D',
        'F' : 'I',
        'G' : 'R',
        'H' : 'L',
        'I' : 'F',
        'J' : 'O',
        'K' : 'A',
        'L' : 'K',
        'M' : 'M',
        'N' : 'X',
        'O' : 'W',
        'P' : 'N',
        'Q' : 'T',
        'R' : 'V',
        'S' : 'E',
        'T' : 'G',
        'U' : 'Y',
        'V' : 'P',
        'W' : 'U',
        'X' : 'J',
        'Y' : 'Z',
        'Z' : 'B',
    },
    'L' : {
        'A' : 'Z',
        'B' : 'B',
        'C' : 'Q',
        'D' : 'C',
        'E' : 'S',
        'F' : 'H',
        'G' : 'D',
        'H' : 'I',
        'I' : 'R',
        'J' : 'L',
        'K' : 'F',
        'L' : 'O',
        'M' : 'A',
        'N' : 'K',
        'O' : 'M',
        'P' : 'X',
        'Q' : 'W',
        'R' : 'N',
        'S' : 'T',
        'T' : 'V',
        'U' : 'E',
        'V' : 'G',
        'W' : 'Y',
        'X' : 'P',
        'Y' : 'U',
        'Z' : 'J',
    },
    'M' : {
        'A' : 'C',
        'B' : 'S',
        'C' : 'H',
        'D' : 'D',
        'E' : 'I',
        'F' : 'R',
        'G' : 'L',
        'H' : 'F',
        'I' : 'O',
        'J' : 'A',
        'K' : 'K',
        'L' : 'M',
        'M' : 'X',
        'N' : 'W',
        'O' : 'N',
        'P' : 'T',
        'Q' : 'V',
        'R' : 'E',
        'S' : 'G',
        'T' : 'Y',
        'U' : 'P',
        'V' : 'U',
        'W' : 'J',
        'X' : 'Z',
        'Y' : 'B',
        'Z' : 'Q',
    },
    'N' : {
        'A' : 'L',
        'B' : 'F',
        'C' : 'O',
        'D' : 'A',
        'E' : 'K',
        'F' : 'M',
        'G' : 'X',
        'H' : 'W',
        'I' : 'N',
        'J' : 'T',
        'K' : 'V',
        'L' : 'E',
        'M' : 'G',
        'N' : 'Y',
        'O' : 'P',
        'P' : 'U',
        'Q' : 'J',
        'R' : 'Z',
        'S' : 'B',
        'T' : 'Q',
        'U' : 'C',
        'V' : 'S',
        'W' : 'H',
        'X' : 'D',
        'Y' : 'I',
        'Z' : 'R',
    },
    'O' : {
        'A' : 'M',
        'B' : 'X',
        'C' : 'W',
        'D' : 'N',
        'E' : 'T',
        'F' : 'V',
        'G' : 'E',
        'H' : 'G',
        'I' : 'Y',
        'J' : 'P',
        'K' : 'U',
        'L' : 'J',
        'M' : 'Z',
        'N' : 'B',
        'O' : 'Q',
        'P' : 'C',
        'Q' : 'S',
        'R' : 'H',
        'S' : 'D',
        'T' : 'I',
        'U' : 'R',
        'V' : 'L',
        'W' : 'F',
        'X' : 'O',
        'Y' : 'A',
        'Z' : 'K',
    },
    'P' : {
        'A' : 'J',
        'B' : 'Z',
        'C' : 'B',
        'D' : 'Q',
        'E' : 'C',
        'F' : 'S',
        'G' : 'H',
        'H' : 'D',
        'I' : 'I',
        'J' : 'R',
        'K' : 'L',
        'L' : 'F',
        'M' : 'O',
        'N' : 'A',
        'O' : 'K',
        'P' : 'M',
        'Q' : 'X',
        'R' : 'W',
        'S' : 'N',
        'T' : 'T',
        'U' : 'V',
        'V' : 'E',
        'W' : 'G',
        'X' : 'Y',
        'Y' : 'P',
        'Z' : 'U',
    },
    'Q' : {
        'A' : 'A',
        'B' : 'K',
        'C' : 'M',
        'D' : 'X',
        'E' : 'W',
        'F' : 'N',
        'G' : 'T',
        'H' : 'V',
        'I' : 'E',
        'J' : 'G',
        'K' : 'Y',
        'L' : 'P',
        'M' : 'U',
        'N' : 'J',
        'O' : 'Z',
        'P' : 'B',
        'Q' : 'Q',
        'R' : 'C',
        'S' : 'S',
        'T' : 'H',
        'U' : 'D',
        'V' : 'I',
        'W' : 'R',
        'X' : 'L',
        'Y' : 'F',
        'Z' : 'O',
    },
    'R' : {
        'A' : 'H',
        'B' : 'D',
        'C' : 'I',
        'D' : 'R',
        'E' : 'L',
        'F' : 'F',
        'G' : 'O',
        'H' : 'A',
        'I' : 'K',
        'J' : 'M',
        'K' : 'X',
        'L' : 'W',
        'M' : 'N',
        'N' : 'T',
        'O' : 'V',
        'P' : 'E',
        'Q' : 'G',
        'R' : 'Y',
        'S' : 'P',
        'T' : 'U',
        'U' : 'J',
        'V' : 'Z',
        'W' : 'B',
        'X' : 'Q',
        'Y' : 'C',
        'Z' : 'S',
    },
    'S' : {
        'A' : 'S',
        'B' : 'H',
        'C' : 'D',
        'D' : 'I',
        'E' : 'R',
        'F' : 'L',
        'G' : 'F',
        'H' : 'O',
        'I' : 'A',
        'J' : 'K',
        'K' : 'M',
        'L' : 'X',
        'M' : 'W',
        'N' : 'N',
        'O' : 'T',
        'P' : 'V',
        'Q' : 'E',
        'R' : 'G',
        'S' : 'Y',
        'T' : 'P',
        'U' : 'U',
        'V' : 'J',
        'W' : 'Z',
        'X' : 'B',
        'Y' : 'Q',
        'Z' : 'C',
    },
    'T' : {
        'A' : 'K',
        'B' : 'M',
        'C' : 'X',
        'D' : 'W',
        'E' : 'N',
        'F' : 'T',
        'G' : 'V',
        'H' : 'E',
        'I' : 'G',
        'J' : 'Y',
        'K' : 'P',
        'L' : 'U',
        'M' : 'J',
        'N' : 'Z',
        'O' : 'B',
        'P' : 'Q',
        'Q' : 'C',
        'R' : 'S',
        'S' : 'H',
        'T' : 'D',
        'U' : 'I',
        'V' : 'R',
        'W' : 'L',
        'X' : 'F',
        'Y' : 'O',
        'Z' : 'A',
    },
    'U' : {
        'A' : 'T',
        'B' : 'V',
        'C' : 'E',
        'D' : 'G',
        'E' : 'Y',
        'F' : 'P',
        'G' : 'U',
        'H' : 'J',
        'I' : 'Z',
        'J' : 'B',
        'K' : 'Q',
        'L' : 'C',
        'M' : 'S',
        'N' : 'H',
        'O' : 'D',
        'P' : 'I',
        'Q' : 'R',
        'R' : 'L',
        'S' : 'F',
        'T' : 'O',
        'U' : 'A',
        'V' : 'K',
        'W' : 'M',
        'X' : 'X',
        'Y' : 'W',
        'Z' : 'N',
    },
    'V' : {
        'A' : 'V',
        'B' : 'E',
        'C' : 'G',
        'D' : 'Y',
        'E' : 'P',
        'F' : 'U',
        'G' : 'J',
        'H' : 'Z',
        'I' : 'B',
        'J' : 'Q',
        'K' : 'C',
        'L' : 'S',
        'M' : 'H',
        'N' : 'D',
        'O' : 'I',
        'P' : 'R',
        'Q' : 'L',
        'R' : 'F',
        'S' : 'O',
        'T' : 'A',
        'U' : 'K',
        'V' : 'M',
        'W' : 'X',
        'X' : 'W',
        'Y' : 'N',
        'Z' : 'T',
    },
    'W' : {
        'A' : 'E',
        'B' : 'G',
        'C' : 'Y',
        'D' : 'P',
        'E' : 'U',
        'F' : 'J',
        'G' : 'Z',
        'H' : 'B',
        'I' : 'Q',
        'J' : 'C',
        'K' : 'S',
        'L' : 'H',
        'M' : 'D',
        'N' : 'I',
        'O' : 'R',
        'P' : 'L',
        'Q' : 'F',
        'R' : 'O',
        'S' : 'A',
        'T' : 'K',
        'U' : 'M',
        'V' : 'X',
        'W' : 'W',
        'X' : 'N',
        'Y' : 'T',
        'Z' : 'V',
    },
    'X' : {
        'A' : 'Y',
        'B' : 'P',
        'C' : 'U',
        'D' : 'J',
        'E' : 'Z',
        'F' : 'B',
        'G' : 'Q',
        'H' : 'C',
        'I' : 'S',
        'J' : 'H',
        'K' : 'D',
        'L' : 'I',
        'M' : 'R',
        'N' : 'L',
        'O' : 'F',
        'P' : 'O',
        'Q' : 'A',
        'R' : 'K',
        'S' : 'M',
        'T' : 'X',
        'U' : 'W',
        'V' : 'N',
        'W' : 'T',
        'X' : 'V',
        'Y' : 'E',
        'Z' : 'G',
    },
    'Y' : {
        'A' : 'W',
        'B' : 'N',
        'C' : 'T',
        'D' : 'V',
        'E' : 'E',
        'F' : 'G',
        'G' : 'Y',
        'H' : 'P',
        'I' : 'U',
        'J' : 'J',
        'K' : 'Z',
        'L' : 'B',
        'M' : 'Q',
        'N' : 'C',
        'O' : 'S',
        'P' : 'H',
        'Q' : 'D',
        'R' : 'I',
        'S' : 'R',
        'T' : 'L',
        'U' : 'F',
        'V' : 'O',
        'W' : 'A',
        'X' : 'K',
        'Y' : 'M',
        'Z' : 'X',
    },
    'Z' : {
        'A' : 'X',
        'B' : 'W',
        'C' : 'N',
        'D' : 'T',
        'E' : 'V',
        'F' : 'E',
        'G' : 'G',
        'H' : 'Y',
        'I' : 'P',
        'J' : 'U',
        'K' : 'J',
        'L' : 'Z',
        'M' : 'B',
        'N' : 'Q',
        'O' : 'C',
        'P' : 'S',
        'Q' : 'H',
        'R' : 'D',
        'S' : 'I',
        'T' : 'R',
        'U' : 'L',
        'V' : 'F',
        'W' : 'O',
        'X' : 'A',
        'Y' : 'K',
        'Z' : 'M',
    },
}

def DecryptSearch(char, keychar) :
    for x, y in full_table.items() :
        for a, b in y.items() :
            if a == keychar and char == b : return x
    return ''

class FullVignereCipher(CipherInterface.StringCipher):
    """Full Vignere cipher description here"""

    def __init__(self, key: str):
        self.key = ''.join([i for i in key.upper() if i.isalpha()])

    def encrypt(self, plaintext: str) -> str:
        """
        Encrypt a given bytearray, returning an encrypted string.
        Overrides StringCipher.encrypt()
        """
        plain_text = ''.join([i for i in plaintext.upper() if i.isalpha()])
        cipher_text = ''
        i = 0
        for a in plain_text :
            cipher_text += full_table[a][self.key[i]]
            i = (i + 1) % len(self.key)
        return cipher_text

    def decrypt(self, ciphertext: str) -> str:
        """
        Decrypt a given bytearray, returning an plaintext string.
        Overrides StringCipher.decrypt()
        """
        cipher_text = ''.join([i for i in ciphertext.upper() if i.isalpha()])
        plain_text = ''
        i = 0
        for a in cipher_text :
            plain_text += DecryptSearch(a, self.key[i])
            i = (i + 1) % len(self.key)
        return plain_text
